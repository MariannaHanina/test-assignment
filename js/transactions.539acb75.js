"use strict";(self["webpackChunktest_assignment"]=self["webpackChunktest_assignment"]||[]).push([[805],{9195:function(t,s,e){e.r(s),e.d(s,{default:function(){return F}});var n=function(){var t=this,s=t._self._c;return s("div",{staticClass:"transactionss"},[s("h1",[t._v("Bitcoin Transactions")]),s("transactions-actions",{on:{start:t.start,stop:t.stop,reset:t.reset}}),t.transactions.length?s("transactions-sum",{attrs:{sum:t.sum}}):t._e(),t.transactions.length?s("transactions-table",{attrs:{transactions:t.transactions}}):t._e(),s("modal-dialog",{directives:[{name:"show",rawName:"v-show",value:!!t.alerts.length,expression:"!!alerts.length"}],on:{close:t.closeModal},scopedSlots:t._u([{key:"header",fn:function(){return[t._v(" Blockchain Connection Alerts ")]},proxy:!0}])},[s("div",t._l(t.alerts,(function({id:e,type:n,message:a}){return s("div",{key:e},[t._v(" "+t._s(n)+": "+t._s(a)+" ")])})),0)])],1)},a=[];e(7658);const r=t=>{const s=[];let e=0;for(let n of t){const{addr:t,value:a}=n.prev_out;s.push(t),e+=a}return{inputsAddresses:s,sumInputsValue:e}},o=t=>{const s=[];let e=0;for(let n of t){const{addr:t,value:a}=n;s.push(t),e+=a}return{outAddresses:s,sumOutValue:e}},i=t=>{if(!t.x)return!1;const{inputs:s,out:e}=t.x,{inputsAddresses:n,sumInputsValue:a}=r(s),{outAddresses:i,sumOutValue:c}=o(e),l=a-c;return{from:n,to:i,sum:l}};function c(t,s){if(s.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l(t,s,e){c(t,s),s.set(t,e)}function u(t,s){return s.get?s.get.call(t):s.value}function d(t,s,e){if(!s.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return s.get(t)}function h(t,s){var e=d(t,s,"get");return u(t,e)}function p(t,s,e){if(s.set)s.set.call(t,e);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=e}}function f(t,s,e){var n=d(t,s,"set");return p(t,n,e),e}var m=new WeakMap;class v{constructor(t){l(this,m,{writable:!0,value:null}),this.url=t}connect(){return f(this,m,new WebSocket(this.url)),new Promise(((t,s)=>{h(this,m).onopen=()=>{1===h(this,m).readyState&&t("connected"),s("rejected")}}))}send(t){const s=JSON.stringify(t);h(this,m).send(s)}onMessage(t){h(this,m).onmessage=s=>{if(s.data){const e=JSON.parse(s.data);t(e)}}}onClose(t){h(this,m).onclose=s=>{let e;e=s.wasClean?"Connection closed cleanly":"Connection failure",console.log(`Code: ${s.code} cause: ${s.reason}`),t({type:"close",message:e})}}onError(t){h(this,m).onerror=s=>{t({type:"error",message:s.message})}}}var b=new WeakMap,_=new WeakMap;class w{constructor(){l(this,b,{writable:!0,value:"wss://ws.blockchain.info/inv"}),l(this,_,{writable:!0,value:null}),f(this,_,new v(h(this,b)))}async connect(){return await h(this,_).connect()}subscribe(){h(this,_).send({op:"unconfirmed_sub"})}unsubscribe(){h(this,_).send({op:"unconfirmed_unsub"})}async getTransaction(t){h(this,_).onMessage(t)}async getAlert(t){h(this,_).onClose(t),h(this,_).onError(t)}}var y=function(){var t=this,s=t._self._c;return s("div",{staticClass:"transactions-actions"},[s("button",{staticClass:"button button-start",attrs:{type:"button"},on:{click:t.start}},[t._v(" Запуск ")]),s("button",{staticClass:"button button-stop",attrs:{type:"button"},on:{click:t.stop}},[t._v(" Остановка ")]),s("button",{staticClass:"button button-reset",attrs:{type:"button"},on:{click:t.reset}},[t._v(" Сброс ")])])},g=[],C={name:"TransactionsActions",emits:["start","stop","reset"],methods:{start(){this.$emit("start")},stop(){this.$emit("stop")},reset(){this.$emit("reset")}}},k=C,T=e(1001),A=(0,T.Z)(k,y,g,!1,null,"b516ef4c",null),x=A.exports,$=function(){var t=this,s=t._self._c;return s("div",{staticClass:"transactions-sum"},[t._v(" Сумма: "+t._s(t._f("BTC")(t.sum))+" ")])},M=[],S={name:"TransactionsSum",props:{sum:{type:Number,default:0}}},E=S,V=(0,T.Z)(E,$,M,!1,null,null,null),Z=V.exports,B=function(){var t=this,s=t._self._c;return s("table",{staticClass:"transaction-table"},[t._m(0),s("tbody",t._l(t.transactions,(function({from:e,to:n,sum:a},r){return s("tr",{key:`trns-${r}`},[s("td",{staticClass:"transaction-table-td"},t._l(e,(function(e,n){return s("div",{key:`frmadd-${n}`},[t._v(t._s(e))])})),0),s("td",{staticClass:"transaction-table-td"},t._l(n,(function(e,n){return s("div",{key:`toadd-${n}`},[t._v(t._s(e))])})),0),s("td",{staticClass:"transaction-table-td"},[t._v(t._s(t._f("BTC")(a))+" ")])])})),0)])},N=[function(){var t=this,s=t._self._c;return s("thead",[s("tr",[s("th",{staticClass:"transaction-table-th"},[t._v("From")]),s("th",{staticClass:"transaction-table-th"},[t._v("To")]),s("th",{staticClass:"transaction-table-th"},[t._v("Sum")])])])}],O={name:"TransactionsTable",props:{transactions:{type:Array,required:!0}}},W=O,j=(0,T.Z)(W,B,N,!1,null,"b92dccf2",null),I=j.exports,J=e(9924),q={name:"TransactionsView",components:{"transactions-actions":x,"transactions-sum":Z,"transactions-table":I,"modal-dialog":J.Z},data(){return{transactions:[],alerts:[]}},async created(){this.service=new w,await this.service.connect()},computed:{sum(){return this.transactions.reduce(((t,{sum:s})=>t+s),0)}},methods:{start(){this.service.subscribe(),this.service.getTransaction(this.addTransaction),this.service.getAlert(this.addAlert)},stop(){this.service.unsubscribe()},reset(){this.transactions=[]},addTransaction(t){const s=i(t);this.transactions=[...this.transactions,s]},addAlert(t){this.alerts=[...this.alerts,{...t,id:Date.now()}]},closeModal(){this.alerts=[]}}},z=q,D=(0,T.Z)(z,n,a,!1,null,"eda9ef32",null),F=D.exports}}]);
//# sourceMappingURL=transactions.539acb75.js.map